# door_hacking.py
import zipfile
import time

def unlock_zip(zip_path):
    start_time = time.time()
    attempts = 0
    charset = 'abcdefghijklmnopqrstuvwxyz0123456789'
    
    try:
        with zipfile.ZipFile(zip_path, 'r') as zip_ref:
            for a in charset:
                for b in charset:
                    for c in charset:
                        for d in charset:
                            for e in charset:
                                for f in charset:
                                    password = f'{a}{b}{c}{d}{e}{f}'
                                    attempts += 1
                                    try:
                                        zip_ref.extractall(pwd=password.encode())
                                        elapsed_time = time.time() - start_time
                                        print(f'Password found: {password}')
                                        print(f'Total attempts: {attempts}')
                                        print(f'Time taken: {elapsed_time:.2f} seconds')
                                        with open('password.txt', 'w') as f:
                                            f.write(password)
                                        return password
                                    except RuntimeError:
                                        continue
    except FileNotFoundError:
        print('Error: ZIP file not found.')
    except Exception as e:
        print(f'Error: {e}')

    print('Password not found.')
    return None

# Usage
zip_path = r'C:\Users\dino1\codyssey\문제2-1\emergency_storage_key.zip'
unlock_zip(zip_path)
